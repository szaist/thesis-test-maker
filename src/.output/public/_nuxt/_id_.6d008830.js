import{o as u,e as g,d as X,b as U,G as q,Q as Y,k as f,s as B,B as H,D as ee,c as v,l as D,w as m,f as l,i as o,x as K,h as p,m as G,n as O,t as Z,F as j,z as te,u as oe,p as le,T as ne}from"./entry.68a40b73.js";import{Q as M}from"./QuestionTypes.2471fd4d.js";import{I as W}from"./IconTrash.c4a4eb84.js";import{_ as ae}from"./_plugin-vue_export-helper.c27b6911.js";import{u as ue}from"./toast-message.98c30be3.js";const de={},ie={class:"pi pi-plus"};function ce(S,I){return u(),g("i",ie)}const se=ae(de,[["render",ce]]),re={class:"flex items-center justify-center mb-4"},me={class:"ml-4"},pe={class:"flex flex-col gap-2"},_e={class:"flex justify-between"},fe={class:"flex justify-center items-center flex-col gap-2"},ve=["disabled"],ge=p("small",null,"Mielőtt képet adhatnál hozzá kérlek mentsd el a tesztet.",-1),ye=X({__name:"AppTestCheckbox",props:{modelValue:{}},emits:["update:modelValue","deleteQuestion"],setup(S,{emit:I}){var _;const z=te(),N=U(q),R=U(Y),y=I,e=S,E=f(-1),c=f(e.modelValue.text),n=f(e.modelValue.Answers),A=f(e.modelValue.QuestionImage),Q=f(),h=f(((_=e.modelValue.Answers)==null?void 0:_.filter(s=>s.point===1).map(s=>s.id))??[]),L=()=>{n.value.push({id:E.value,text:"",point:0}),E.value--},a=async s=>{var d;const t=n.value[s].id;t>0&&await N.delete(t),n.value=(d=n.value)==null?void 0:d.filter((k,w)=>s!==w)},V=async s=>{var d;const t=s.target;if(Q.value=(d=t.files)==null?void 0:d[0],e.modelValue.id){const k=new FormData;k.append("image",Q.value);const w=await R.uploadImage(e.modelValue.id,k);A.value=w}},$=B(()=>!e.modelValue.id||e.modelValue.id<0);H(n,()=>{r()}),H(c,()=>{r()});const r=()=>{ee(()=>{y("update:modelValue",b.value)})},b=B(()=>{var s;return{id:e.modelValue.id,text:c.value,type:e.modelValue.type,QuestionImage:A.value,Answers:(s=n.value)==null?void 0:s.map(t=>({id:t.id,point:Number(h.value.includes(t.id)),text:t.text}))}});return(s,t)=>{const d=v("InputText"),k=v("Image"),w=v("Checkbox"),P=v("Panel"),T=v("Button"),J=v("Card");return u(),D(J,null,{title:m(()=>[l(d,{modelValue:o(c),"onUpdate:modelValue":t[0]||(t[0]=x=>K(c)?c.value=x:null),placeholder:"Kérdés",class:"w-full"},null,8,["modelValue"])]),content:m(()=>{var x;return[p("div",re,[e.modelValue.QuestionImage?(u(),D(k,{key:0,src:`${o(z).public.API_BASE_URL}question/image/${(x=e.modelValue.QuestionImage)==null?void 0:x.source}`,width:"500"},null,8,["src"])):G("",!0)]),l(P,{header:"Helyes válaszok",class:"mb-4"},{default:m(()=>[(u(!0),g(j,null,O(o(n),(F,i)=>(u(),g("div",{key:i,class:"mb-3"},[l(w,{modelValue:o(h),"onUpdate:modelValue":t[1]||(t[1]=C=>K(h)?h.value=C:null),value:F.id,onChange:r},null,8,["modelValue","value"]),p("label",me,Z(o(n)[i].text.substring(0,40)),1)]))),128))]),_:1}),l(P,{header:"Válaszok"},{default:m(()=>[p("div",pe,[(u(!0),g(j,null,O(o(n),(F,i)=>(u(),g("div",{key:i,class:"flex items-center"},[l(d,{modelValue:o(n)[i].text,"onUpdate:modelValue":C=>o(n)[i].text=C,placeholder:`Válasz ${i+1}`,class:"w-full",onChange:r},null,8,["modelValue","onUpdate:modelValue","placeholder"]),l(T,{class:"ml-2",severity:"danger",rounded:"",text:"",onClick:C=>a(i)},{default:m(()=>[l(W)]),_:2},1032,["onClick"])]))),128))]),l(T,{rounded:"",class:"mt-4",onClick:L},{default:m(()=>[l(se)]),_:1})]),_:1})]}),footer:m(()=>[p("div",_e,[p("div",fe,[p("input",{id:"myfile",disabled:o($),type:"file",name:"myfile",accept:".png, .jpg, .jpeg",onChange:V},null,40,ve),ge]),l(T,{text:"",rounded:"",severity:"danger",onClick:t[2]||(t[2]=x=>y("deleteQuestion"))},{default:m(()=>[l(W)]),_:1})])]),_:1})}}}),Ve={class:"flex items-center justify-center mb-4"},he={class:"ml-4"},ke={class:"flex flex-col gap-2"},we={class:"flex justify-between"},xe={class:"flex justify-center items-center flex-col gap-2"},be=["disabled"],Ce=p("small",null,"Mielőtt képet adhatnál hozzá kérlek mentsd el a tesztet.",-1),Ie=X({__name:"AppTestRadio",props:{modelValue:{}},emits:["update:modelValue","deleteQuestion"],setup(S,{emit:I}){var _;const z=te(),N=U(q),R=U(Y),y=I,e=S,E=f(-1),c=f(e.modelValue.text),n=f(e.modelValue.Answers),A=f(e.modelValue.QuestionImage),Q=f(),h=f(((_=e.modelValue.Answers)==null?void 0:_.findIndex(s=>s.point===1))??-1),L=()=>{n.value.push({id:E.value,text:"",point:0}),E.value--},a=async s=>{var d;const t=n.value[s].id;t>0&&await N.delete(t),n.value=(d=n.value)==null?void 0:d.filter((k,w)=>s!==w)},V=async s=>{var d;const t=s.target;if(Q.value=(d=t.files)==null?void 0:d[0],e.modelValue.id){const k=new FormData;k.append("image",Q.value);const w=await R.uploadImage(e.modelValue.id,k);A.value=w}},$=B(()=>!e.modelValue.id||e.modelValue.id<0);H([...n.value],()=>{r()}),H(c,()=>{r()});const r=()=>{ee(()=>{y("update:modelValue",b.value)})},b=B(()=>{var s;return{id:e.modelValue.id,text:c.value,type:M.SELECT_ONE,QuestionImage:A.value,Answers:(s=n.value)==null?void 0:s.map((t,d)=>({id:t.id,point:d===h.value?1:0,text:t.text}))}});return(s,t)=>{const d=v("InputText"),k=v("Image"),w=v("RadioButton"),P=v("Panel"),T=v("Button"),J=v("Card");return u(),D(J,null,{title:m(()=>[l(d,{modelValue:o(c),"onUpdate:modelValue":t[0]||(t[0]=x=>K(c)?c.value=x:null),placeholder:"Kérdés",class:"w-full"},null,8,["modelValue"])]),content:m(()=>{var x;return[p("div",Ve,[e.modelValue.QuestionImage?(u(),D(k,{key:0,src:`${o(z).public.API_BASE_URL}question/image/${(x=e.modelValue.QuestionImage)==null?void 0:x.source}`,width:"500"},null,8,["src"])):G("",!0)]),l(P,{header:"Helyes válaszok",class:"mb-4"},{default:m(()=>[(u(!0),g(j,null,O(o(n),(F,i)=>(u(),g("div",{key:i,class:"mb-3"},[l(w,{modelValue:o(h),"onUpdate:modelValue":t[1]||(t[1]=C=>K(h)?h.value=C:null),value:i,onChange:r},null,8,["modelValue","value"]),p("label",he,Z(o(n)[i].text.substring(0,40)),1)]))),128))]),_:1}),l(P,{header:"Válaszok"},{default:m(()=>[p("div",ke,[(u(!0),g(j,null,O(o(n),(F,i)=>(u(),g("div",{key:i,class:"flex items-center"},[l(d,{modelValue:o(n)[i].text,"onUpdate:modelValue":C=>o(n)[i].text=C,placeholder:`Válasz ${i+1}`,class:"w-full"},null,8,["modelValue","onUpdate:modelValue","placeholder"]),l(T,{class:"ml-2",severity:"danger",rounded:"",text:"",onClick:C=>a(i)},{default:m(()=>[l(W)]),_:2},1032,["onClick"])]))),128))]),l(T,{rounded:"",class:"mt-4",onClick:L},{default:m(()=>[l(se)]),_:1})]),_:1})]}),footer:m(()=>[p("div",we,[p("div",xe,[p("input",{id:"myfile",disabled:o($),type:"file",name:"myfile",accept:".png, .jpg, .jpeg",onChange:V},null,40,be),Ce]),l(T,{text:"",rounded:"",severity:"danger",onClick:t[2]||(t[2]=x=>y("deleteQuestion"))},{default:m(()=>[l(W)]),_:1})])]),_:1})}}}),Qe={class:"flex justify-center mt-2"},$e={class:"max-w-5xl w-full flex flex-col gap-4"},Ee={key:0,class:"flex-1 flex justify-center items-center"},Ae={class:"text-xl text-white font-bold mt-4"},Te={key:2,class:"flex flex-col gap-2"},je=X({__name:"[id]",setup(S){const I=ue(),z=U(ne),N=U(Y),R=oe(),y=f(!0),e=f(),E=async()=>{try{y.value=!0;const a=await z.findById(Number(R.params.id));e.value=a}catch{}y.value=!1},c=B(()=>{var a;return((a=e.value)==null?void 0:a.Questions)??[]}),n=()=>{var a;(a=e.value)==null||a.Questions.push({id:Number(Date.now())*-1,Answers:[],text:"",type:M.SELECT_MORE,QuestionImage:null})},A=()=>{var a;(a=e.value)==null||a.Questions.push({id:Number(Date.now())*-1,Answers:[],text:"",type:M.SELECT_ONE,QuestionImage:null})},Q=async a=>{const V=e.value.Questions[a];V!=null&&V.id&&await N.delete(V.id),e.value.Questions=e.value.Questions.filter(($,r)=>r!==a)},h=B(()=>{var a,V;return((V=(a=e.value)==null?void 0:a.Questions)==null?void 0:V.every($=>$.Answers.some(r=>r.point!==0)))??!1}),L=async()=>{try{if(h.value){y.value=!0;const a=await z.save(Number(R.params.id),e.value);e.value=a,I.showSuccess({message:"Sikeres mentés!"})}else I.showError({message:"Kérlek adj meg minden kérdésnél legalább egy helyes választ."})}catch{I.showError({message:"Hiba történt a mentés során!"})}y.value=!1};return le(()=>{E()}),(a,V)=>{const $=v("ProgressSpinner"),r=v("Button");return u(),g("div",Qe,[p("div",$e,[o(y)?(u(),g("div",Ee,[l($)])):(u(!0),g(j,{key:1},O(o(c),(b,_)=>(u(),g(j,{key:_},[p("h2",Ae,Z(`${_+1}. kérdés`),1),(b==null?void 0:b.type)==o(M).SELECT_MORE?(u(),D(ye,{key:0,modelValue:o(c)[_],"onUpdate:modelValue":s=>o(c)[_]=s,onDeleteQuestion:s=>Q(_)},null,8,["modelValue","onUpdate:modelValue","onDeleteQuestion"])):(b==null?void 0:b.type)==o(M).SELECT_ONE?(u(),D(Ie,{key:1,modelValue:o(c)[_],"onUpdate:modelValue":s=>o(c)[_]=s,onDeleteQuestion:s=>Q(_)},null,8,["modelValue","onUpdate:modelValue","onDeleteQuestion"])):G("",!0)],64))),128)),o(y)?G("",!0):(u(),g("div",Te,[l(r,{label:"Több válaszlehetőséges kérdés hozzáadása","icon-class":"pi pi-plus",onClick:n}),l(r,{label:"Egy válaszlehetőséges kérdés hozzáadása",onClick:A}),l(r,{label:"Mentés",class:"my-5",onClick:L})]))])])}}});export{je as default};
