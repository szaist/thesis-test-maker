import{k as h,P as k,R as y,D as g,B as w,S,V as v,N as T,b as p,W as b,s as C,U as E}from"./entry.68a40b73.js";const f=/^[\u0009\u0020-\u007E\u0080-\u00FF]+$/;function A(e,r){if(typeof e!="string")throw new TypeError("argument str must be a string");const t={},s=(r||{}).decode||R;let n=0;for(;n<e.length;){const i=e.indexOf("=",n);if(i===-1)break;let a=e.indexOf(";",n);if(a===-1)a=e.length;else if(a<i){n=e.lastIndexOf(";",i-1)+1;continue}const u=e.slice(n,i).trim();if(t[u]===void 0){let c=e.slice(i+1,a).trim();c.codePointAt(0)===34&&(c=c.slice(1,-1)),t[u]=N(c,s)}n=a+1}return t}function m(e,r,t){const o=t||{},s=o.encode||U;if(typeof s!="function")throw new TypeError("option encode is invalid");if(!f.test(e))throw new TypeError("argument name is invalid");const n=s(r);if(n&&!f.test(n))throw new TypeError("argument val is invalid");let i=e+"="+n;if(o.maxAge!==void 0&&o.maxAge!==null){const a=o.maxAge-0;if(Number.isNaN(a)||!Number.isFinite(a))throw new TypeError("option maxAge is invalid");i+="; Max-Age="+Math.floor(a)}if(o.domain){if(!f.test(o.domain))throw new TypeError("option domain is invalid");i+="; Domain="+o.domain}if(o.path){if(!f.test(o.path))throw new TypeError("option path is invalid");i+="; Path="+o.path}if(o.expires){if(!D(o.expires)||Number.isNaN(o.expires.valueOf()))throw new TypeError("option expires is invalid");i+="; Expires="+o.expires.toUTCString()}if(o.httpOnly&&(i+="; HttpOnly"),o.secure&&(i+="; Secure"),o.priority)switch(typeof o.priority=="string"?o.priority.toLowerCase():o.priority){case"low":i+="; Priority=Low";break;case"medium":i+="; Priority=Medium";break;case"high":i+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(o.sameSite)switch(typeof o.sameSite=="string"?o.sameSite.toLowerCase():o.sameSite){case!0:i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"strict":i+="; SameSite=Strict";break;case"none":i+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return i}function D(e){return Object.prototype.toString.call(e)==="[object Date]"||e instanceof Date}function N(e,r){try{return r(e)}catch{return e}}function R(e){return e.includes("%")?decodeURIComponent(e):e}function U(e){return encodeURIComponent(e)}const O={path:"/",watch:!0,decode:e=>v(decodeURIComponent(e)),encode:e=>encodeURIComponent(typeof e=="string"?e:JSON.stringify(e))};function I(e,r){var u;const t={...O,...r},o=P(t)||{};let s;t.maxAge!==void 0?s=t.maxAge*1e3:t.expires&&(s=t.expires.getTime()-Date.now());const n=s!==void 0&&s<=0,i=n?void 0:o[e]??((u=t.default)==null?void 0:u.call(t)),a=s&&!n?j(i,s):h(i);{const c=typeof BroadcastChannel>"u"?null:new BroadcastChannel(`nuxt:cookies:${e}`),l=()=>{M(e,a.value,t),c==null||c.postMessage(t.encode(a.value))};let d=!1;k()&&y(()=>{d=!0,l(),c==null||c.close()}),c&&(c.onmessage=x=>{d=!0,a.value=t.decode(x.data),g(()=>{d=!1})}),t.watch?w(a,()=>{d||l()},{deep:t.watch!=="shallow"}):l()}return a}function P(e={}){return A(document.cookie,e)}function L(e,r,t={}){return r==null?m(e,r,{...t,maxAge:-1}):m(e,r,t)}function M(e,r,t={}){document.cookie=L(e,r,t)}function j(e,r){let t;return y(()=>{clearTimeout(t)}),S((o,s)=>({get(){return o(),e},set(n){clearTimeout(t),t=setTimeout(()=>{e=void 0,s()},r),e=n,s()}}))}const F=T("useAuthStore",()=>{const e=p(b),r=h(null),t=I("token",{maxAge:60*60*24}),o=C(()=>({token:(t==null?void 0:t.value)||null})),s=async()=>{try{const n=p(E);if(!t.value)return;r.value=await n.me()}catch{t.value=null}};return w(o,n=>{n.token!==null&&(e.setToken(n.token),s())},{immediate:!0}),{token:t,authUser:r,fetchUser:s}});export{F as u};
